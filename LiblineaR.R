#preprocessing
newdata = read.csv("data.csv",as.is =TRUE, header=FALSE)
trainLabels = read.csv("trainLabels.csv", as.is =TRUE)

#combine data wiht trainLabels
newtrain = merge(newdata,trainLabels, by.x ="V42", by.y ="Id")
order = append(setdiff(names(newtrain),c('V42','Class')) , c('V42','Class'))
newtrain = newtrain[c(order)]

#Removing the non numeric columns
leftOut = setdiff(names(newtrain), "V42")
trainFinal = newtrain[c(leftOut)]

#Train LiblineaR
require(LiblineaR)
# Add dummy column
leftOuts = setdiff(names(trainFinal), c('Class','V41','V40'))
trainForLinear = trainFinal[c(leftOuts)]
pred = trainFinal$Class
modelLinear = LiblineaR(data=trainForLinear,target = pred,type=0,cross=10)


#For test preprocess it
test=read.csv("data3.csv",as.is=TRUE,header=FALSE)
#remove filename
#adjust columns and set col names
leftOuts = setdiff(names(test), c('X1367070','X1320','V42'))
testFinal = test[c(leftOuts)]
predLinear = predict(modelLinear,testFinal,proba=TRUE)



